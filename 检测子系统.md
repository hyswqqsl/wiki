# 监测子系统接口设计

![Main](http://112.124.104.190:10001/soft/wiki/uploads/8e5d1afea4d2cf1cdbdd6acad768b481/Main.png)

## SensorController，仪表控制层
1. 取得仪表列表, /sensor/lists, GET
    * 参数：
        * token: 用于验证用户身份，使用对称加密算法
    * 返回:
        * OK:仪表列表，所有属性    
        * 4010: UNAUTHORIZED 无访问权限，token未通过验证
2. 取得仪表当天数据，/sensor/data/day, GET
    * 参数：
        * token: 用于验证用户身份，使用对称加密算法
        * code：仪表唯一编码
    * 返回：
        * OK:仪表数据列表，仪表数据(sensorData)所有属性
        * 4010: UNAUTHORIZED 无访问权限，仪表数据不属于这个token中标识的用户
3. 取得仪表数据,/sensor/data, GET
    * 如果查询时间超过1个月，每1小时返回1条数据
    * 参数：
        * token: 用于验证用户身份，使用对称加密算法
        * code：仪表唯一编码
        * beginDate: 开始时间
        * endDate: 结束时间
    * 返回：
        * OK:仪表数据列表，仪表数据(sensorData)所有属性
        * 4010: UNAUTHORIZED 无访问权限，仪表数据不属于这个token中标识的用户

## 水利云后台 StationController        
1. **监测取得测站参数：getParameters，GET**
    * 这是监测系统取得所有已改变的参数列表
    * 参数：token
    * 返回：OK：返回包含测站唯一编码，测站名，所有仪表编码，以及参数，格式：`[{instanceId:xx,name:xxx,sensors:[{code:xx},{code:xx}],parameters:(json)}, {...}]`

## 补充一下，水利云前台或安布雷拉监测系统，请求监测数据时，发送token，token包含用户信息，监测吧token发给水利云后台验证用户信息，保证token中包含用户信息，给此生成的token都是唯一的，token验证一次失效

