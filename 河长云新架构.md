<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
**Table of Contents**  *generated with [DocToc](https://github.com/thlorenz/doctoc)*

- [河长云新架构接口](#%E6%B2%B3%E9%95%BF%E4%BA%91%E6%96%B0%E6%9E%B6%E6%9E%84%E6%8E%A5%E5%8F%A3)
  - [河长云类结构](#%E6%B2%B3%E9%95%BF%E4%BA%91%E7%B1%BB%E7%BB%93%E6%9E%84)
  - [一 系统管理员，SystemAdminController](#%E4%B8%80-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%98systemadmincontroller)
  - [二 平台，PlatformController](#%E4%BA%8C-%E5%B9%B3%E5%8F%B0platformcontroller)
  - [三 河湖，WaterResourceController](#%E4%B8%89-%E6%B2%B3%E6%B9%96waterresourcecontroller)
  - [五 扩展项, ExtraController](#%E4%BA%94-%E6%89%A9%E5%B1%95%E9%A1%B9-extracontroller)
  - [六 行政区, RegionController](#%E5%85%AD-%E8%A1%8C%E6%94%BF%E5%8C%BA-regioncontroller)
  - [七 河湖段，segmentController](#%E4%B8%83-%E6%B2%B3%E6%B9%96%E6%AE%B5segmentcontroller)
  - [八 成员单位，UnitController](#%E5%85%AB-%E6%88%90%E5%91%98%E5%8D%95%E4%BD%8Dunitcontroller)
  - [九 成员单位用户，UnitUserController](#%E4%B9%9D-%E6%88%90%E5%91%98%E5%8D%95%E4%BD%8D%E7%94%A8%E6%88%B7unitusercontroller)
  - [十 公众号菜单接口,WeChatController,GET](#%E5%8D%81-%E5%85%AC%E4%BC%97%E5%8F%B7%E8%8F%9C%E5%8D%95%E6%8E%A5%E5%8F%A3wechatcontrollerget)
  - [十一 河湖长 HzUserController](#%E5%8D%81%E4%B8%80-%E6%B2%B3%E6%B9%96%E9%95%BF-hzusercontroller)
  - [十二 投诉，ComplaintControler](#%E5%8D%81%E4%BA%8C-%E6%8A%95%E8%AF%89complaintcontroler)
  - [十三 新闻动态和政策方案, ArticleController](#%E5%8D%81%E4%B8%89-%E6%96%B0%E9%97%BB%E5%8A%A8%E6%80%81%E5%92%8C%E6%94%BF%E7%AD%96%E6%96%B9%E6%A1%88-articlecontroller)
  - [十四 事件管理, MatterController](#%E5%8D%81%E5%9B%9B-%E4%BA%8B%E4%BB%B6%E7%AE%A1%E7%90%86-mattercontroller)
  - [十五 巡河控制层, CruiseController](#%E5%8D%81%E4%BA%94-%E5%B7%A1%E6%B2%B3%E6%8E%A7%E5%88%B6%E5%B1%82-cruisecontroller)
  - [十六 信息收发，UnitContactController](#%E5%8D%81%E5%85%AD-%E4%BF%A1%E6%81%AF%E6%94%B6%E5%8F%91unitcontactcontroller)
  - [十七 PanoramaController，全景](#%E5%8D%81%E4%B8%83-panoramacontroller%E5%85%A8%E6%99%AF)
  - [门户使用的接口](#%E9%97%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E7%9A%84%E6%8E%A5%E5%8F%A3)
  - [水利地图使用的接口](#%E6%B0%B4%E5%88%A9%E5%9C%B0%E5%9B%BE%E4%BD%BF%E7%94%A8%E7%9A%84%E6%8E%A5%E5%8F%A3)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

# 河长云新架构接口

## 河长云类结构
![image](https://github.com/hyswqqsl/wiki/blob/master/image/%E6%B2%B3%E9%95%BF%E4%BA%91%E6%96%B0%E6%9E%B6%E6%9E%84.jpg)

## 一 系统管理员，SystemAdminController 
1. 登录发送验证码: /systemAdmin/login/getLoginVerify,GET
   * **角色：无**
   * 系统管理员登录时，取得验证码
   * 参数：
      * phone:登录手机号
   * 返回：
      * OK:发送成功
      * DATA_NOEXIST:账号不存在
2. 登录：/systemAdmin/login,POST
   * **角色：无**
   * 每次登录都是用动态验证码
   * 参数：
      * verification:验证码
   * 返回:
      * OK:成功成功
      * 4041: CODE_INVALID 验证码过期´¨
      * 4042: CODE_ERROR 验证码输入错误
3. 取得系统管理员，/systemAdmin/getUser,GET
   * **角色：无**
   * 参数：
   * 返回：
      * OK(系统管理员对象)，包含系统员属性和角色
      * 4011: NO_SESSION,未登录
4. 系统管理员注销,/systemAdmin/logout POST
   * **角色：系统管理员**
   * 参数：无
   * 返回：OK,注销成功
                

## 二 平台，PlatformController
1. 新建平台，/platform/systemAdmin/create, POST
   * **角色：系统管理员**
   * 参数:
     * name: 平台名称
     * regionCode：对应的行政区编码
     * type: 平台类型，FULL_PLATFORM：完整，WECHAT_PLATFORM： 微信公众号
     * appId: 微信appId
     * appSecret: 微信appSecret
   * 返回:
     * OK，新建成功
     * DATA_EXIST: 对应的行政区已有平台，或appId已使用
2. 取得平台列表, /platform/systemAdmin/list, GET
   * **角色：系统管理员**
   * 参数: 无
   * 返回：
     * OK，返回数组，每项包含平台中所有属性
3. 编辑平台, /platform/systemAdmin/edit, POST
   * **角色：系统管理员**
   * 参数:
     * id: 平台id
     * name: 平台名称
     * regionCode：对应的行政区编码
     * type: 平台类型，FULL_PLATFORM：完整，WECHAT_PLATFORM： 微信公众号
     * appId: 微信appId
     * appSecret: 微信appSecret
   * 返回:
     * OK，编辑成功
     * DATA_NOEXIST: 平台不存在
     * DATA_EXIST: 对应的行政区已有平台，或appId已使用
     * DATA_LOCK: 平台下已有行政区结构，不能修改行政区编码
4. 删除平台, /platform/systemAdmin/delete{id}，DELETE
   * **角色：系统管理员**
   * 平台下如果有河流，水资源，行政区，公众号号菜单，新闻菜单，新闻动态，通报，不能删除
   * 参数: id
   * 返回:
	 * OK，删除成功
	 * DATA_NOEXIST,平台不存在
	 * DATA_LOCK, 平台下有数据，不能删除

## 三 河湖，WaterResourceController
1. 新建河湖, /waterResource/systemAdmin/node/create, POST
    * **web使用**
    * **角色：系统管理员**
    * 如果是顶级节点，如全国，pId为0
    * regionLevel 河流级别 自动确定，和上级一致
    * type  自动确定，和上级一致
    * 参数：
        * platformId,平台id 
        * pId,父级节点id
        * name,节点名
    * 返回：
        * OK,新建成功,返回新建的节点{id:xx,name:xxx,regionLevel, type, pId:xxx}
        * DATA_NOEXIST,parengId不存在 
2. 取得ZTree河湖json,/waterResource/systemAdmin/tree,GET
   * 角色：系统管理员
   * 参数:
   * regionCode:行政区编码
   * 返回：
   * OK,返回河湖zTree使用的json     
3. 编辑河湖，/waterResource/systemAdmin/edit, POST
   * **角色：系统管理员**
   * 如果原类型是河流，不可修改类型
   * 如果是类型是河流，不需要coor点坐标   
   * 参数：
     * id: 河湖id
	 * name, 节点名
	 * code,编码
	 * type: 类型
     * regionLevel，行政区级别	 
	 * remark: 备注
	 * @ coor: 非河流，如湖泊，水库有点坐标 
	 * @ imageUrl，封面图片
     * @ content,河湖概况内容
   * 返回：
	 * OK： 编辑成功
	 * DATA_NOEXIST: 水资源或河流不存在
	 * DATA_LOCK: 河流不能编辑类型
4. 编辑河湖档案属性,/waterResource/systemAdmin/attribute/edit
   * **角色：系统管理员**
   * 参数： 
	 * id：河湖id
	 * attributes: [{alias:xxx, value:xxx}, {...}]
   * 返回：
	 * OK，保存成功
     * DATA_NOEXIST,河湖不存在	
5. 系统管理员取得河湖详情: /waterResource/systemAdmin/details/{id}, GET
   * **角色：系统管理员**
   * 参数： id：河流id
   * 返回：
     * OK，返回河湖所有属性，河湖档案的所有属性，河湖档案下所有属性(基础+动态)，根据xml配置的结构返回json及，所有坐标
     * DATA_NOEXIST,河流不存在        
6. 删除河湖节点，/waterResource/systemAdmin/node/delete/{id},DELETE
   * 角色：系统管理员
   * 如果节点不是叶子节点，不能删除
   * 如果河湖下有有河湖段划分，河湖档案下有扩展项，不能删除
   * 删除时，要把属性删除
   * 参数：
   * id,节点id
   * 返回:
      * OK,删除成功
      * DATA_NOEXIST,id不存在
      * FAIL，删除失败，河湖下有数据	 
7. 门户地图取得平台下所有河湖坐标,/waterResource/portal/map/lists,GET
   * 角色：无
   * 河流是中心线坐标，非河流是点坐标
   * 参数：regionCode: 行政区编码
   * 返回：
      * OK，返回json列表，{rivers:[{id:xxx,name:xxx, remark:xxx, code:xxx, regionLevel:xxx,coors:[]},{...}, heUserName:xxx], lakes:[{id:xxx,name:xxx, remark:xxx, type:xxx,typeC:xxx, code:xxx, regionLevel:xxx, regionLevelC:xxx,coor:{lon:xxx,lat:xxx}}, {...}], heUserName:xxx}
      * DATA_NOEXIST，平台不存在
      * FAIL,文件格式错误
8. 门户取得河湖列表,/waterResource/portal/lists,GET
    * **角色：无**   
    * 增加 introduce 字段，内容缩略100字
    * 增加 riverId 字段
    * 参数：
       * regionCode: 行政区编码
    * 返回：
        * OK,返回一河一档列表,每个对象包含,{id, name,code, remark, imageUrl, introduce, type,typeC, regionType, regionTypeC, createDate}
9. 门户取得河湖档案，/waterResource/portal/details/{id}, GET
   * **角色：无**
   * 返回：
	 * OK，返回河流(水资源)所有属性，河湖档案的所有属性，基础属性
     * DATA_NOEXIST,河流不存在
	 * DATA_REFUSE, 不是本平台的河流，不能查看    
10. 取得河湖档案全部属性,/waterResource/details/{id},GET
   * **角色：所有登录系统的人员，只要有session**
   * 参数： id：河湖id
   * 返回：
	 * OK，返回河湖所有属性，河湖档案的所有属性，河湖档案下所有属性(基础+动态)，河流下的河长列表{id:xxx,name:xxx,remark:xxx,content:xxx.imageUrl:xxx,baseAttributes:[], groupAttributes:[], hzUsers:[]}
     * DATA_NOEXIST,河流不存在	
11. 地图取得河湖二级图层数据，/waterResource/second/details/{id},GET
   * **角色：所有登录系统的人员，只要有session**
   * 参数： id：河湖id
   * 返回：
	 * OK，返回河湖所有坐标属性，名称，备注，类型，code等
     * DATA_NOEXIST,河流不存在

## 五 扩展项, ExtraController
1. 取得扩展项分类,/extra/type/download,GET
   * **角色：所有登录的有session的角色**
   * 参数：
	 * 无
   * 返回：   
	 * OK,json:[{display:"line",type:xxx, name:xxx},{...}]    
2. 取得扩展项列表,/extra/lists
   * **角色：所有登录的有session的角色**
   * 参数：
      * waterResourceId, 河湖id
   * 返回：
	 * OK，扩展项列表，[{id，name，type，childType,coors},{...}]
	 * DATA_NOEXIST,河湖档案不存在
2. 取得扩展项详情,/extra/details/{id},GET
   * **角色：所有登录的有session的角色**
   * 参数：
	 * id，扩展项id
   * 返回：
	 * OK，扩展项所有属性,包含下面的属性,根据xml配置的结构返回json
	 * DATA_NOEXIST,扩展项不存在   
3. 新建扩展项,/extra/systemAdmin/create,POST
   * **角色：系统管理员**
   * 参数：
	 * archiveId，河湖档案id
	 * name，名称
	 * type, point-点，line-线，area-面
	 * childType, 每个分类的childType见 扩展项类型
   * 返回：
	 * OK,新建成功，返回扩展项所有属性
	 * DATA_NOEXIST,河湖档案不存在
	 * FAIL,类型错误
4. 编辑扩展项,/extra/systemAdmin/edit, POST
   * **角色：系统管理员**
   * 如果是点类型扩展项，编辑时，必须传递坐标点
   * 如果是线面类型扩展项，编辑时，坐标点不传
   * 参数：
	 * id，扩展项id
	 * name，名称
	 * type, point-点，line-线，area-面
	 * childType, 每个分类的childType见 扩展项类型
	 * @ coors: 坐标
   * 返回：
	 * OK,新建成功，返回扩展项所有属性
	 * DATA_NOEXIST,扩展项不存在
	 * DATA_LOCK,如果扩展项下有属性，不能修改类型
	 * FAIL,类型错误
3. 上传扩展项坐标，/extra/systemAdmin/upload/coors,POST
   * **角色：系统管理员**
   * excel包含一个线面坐标
   * 参数：
       * id,扩展项id
       * file,上传的excel文件
   * 返回：
       * OK，上传成功，返回扩展项所有属性
       * DATA_NOEXIST，扩展项不存在
       * FAIL,文件格式错误
4. 下载扩展项坐标, /extra/systemAdmin/download/coors,GET
   * **角色：系统管理员**
   * 参数：
       * id,扩展项id
   * 返回：
       * OK，下载成功，返回excel流，浏览器保存为excel文件
       * DATA_NOEXIST，扩展项不存在
       * FAIL,文件格式错误
5. 删除扩展项,/extra/systemAdmin/delete, POST
   * **角色：系统管理员**   
   * 删除时，要把扩展项下的的属性删除   
   * 参数：
       * id,扩展项id
   * 返回：
       * OK，删除成功
       * DATA_NOEXIST，扩展项不存在
7. 编辑扩展项属性,/extra/systemAdmin/attribute/edit
   * **角色：系统管理员**
   * 参数： 
	 * id：扩展项id
	 * attributes: [{alias:xxx, value:xxx}, {...}]
   * 返回：
	 * OK，保存成功
     * DATA_NOEXIST,扩展项不存在
	   
## 六 行政区, RegionController
1. 新建行政区节点，/region/systemAdmin/node/create,POST
   * **角色：系统管理员**
   * 如果是顶级节点，如西宁平台的西宁市节点，pId为0
   * 如果不是父节点，name新建的节点级别默认是父节点的下一级
   * 参数：
	 * platformId, 平台id 
	 * pId,父级节点id
	 * name,节点名
   * 返回：
	 * OK,新建成功,返回新建的节点{id:xx,name:xxx,pId:xxx}
	 * DATA_NOEXIST: 平台或父节点不存在
2. 系统管理员取得行政区zTree结构json，/region/systemAdmin/tree,GET
   * **角色：系统管理员**
   * 得到前台显示用的region属性结构json串
   * 参数：
	 * regionCode:行政区编码
   * 返回：
	 * OK，zTree的json串
	 * DATA_NOEXIST 平台不存在 		
3. 系统管理员修改行政区节点，/region/systemAdmin/node/update,POST
   * **角色：系统管理员**
   * 参数：
	 * id,节点id
	 * name,节点名
	 * code,编码
	 * level,级别 PROVINCE("省级"), CITY("市州级"), COUNTY("县级"), TOWN("乡镇级"), VILLAGE("村级")
	 * remark,备注
   * 返回：
	 * OK,修改成功
	 * DATA_NOEXIST,id不存在
	 * DATA_LOCK, 有子节点，不能编辑级别
	 * DATA_REFUSE, 级别高于父节点，级别设置错误
4. 系统管理员删除行政区节点，/region/systemAdmin/node/delete/{id},DELETE
   * **角色：系统管理员**
   * 如果节点不是叶子节点，不能删除
   * 如果下面有河长，责任单位，不能删除
   * 参数：
	 * id,节点id
   * 返回:
	 * OK,删除成功
	 * DATA_NOEXIST,id不存在
	 * DATA_LOCK，删除失败，行政区下有数据
5. 系统管理员取得行政区详情，/region/systemAdmin/details/{id},GET
   * **角色：系统管理员**
   * 参数：
	 * id,行政区id
   * 返回:
	 * OK,行政区所有属性,行政区所有属性，新闻菜单列表，公众号菜单列表
	 * DATA_NOEXIST,行政区不存在
6. 河长办得zTree结构json，/region/tree,GET
   * 角色：河长办人员
   * 得到前台显示用的region属性结构json串
   * 河长办人员登陆后,要把平台id存在session中,取得行政区zTree时,使用平台id
   * 参数：无
   * 返回：
	 * OK，zTree的json串
7. 河长办管理员取得行政区详情，/region/details/{id},GET
   * 角色：河长办人员
   * 参数：
	 * id,行政区id
   * 返回:
	 * OK,行政区所有属性,河长列表，河长办，河长办用户列表，责任单位类别
	 * DATA_NOEXIST,行政区不存在
	 * DATA_REFUSE,不是本平台的政区，不能查看
      
## 七 河湖段，segmentController
1. 取得河段zTree结构json，/segment/systemAdmin/river/tree,GET
    * **角色：所有登录系统的人员，只要有session**
    * 得到前台显示用的segment属性结构json串
    * 包含河段属性+所属行政区列表+每个行政区下河长列表
    * 如果是顶级节点，所属行政区列表时所有市州级行政区，如果不是顶级节点，所属行政区是上级行政区的下级行政区列表
    * 参数：
       * riverId,河流id
    * 返回：
        * OK，JSON
        * DATA_NOEXIST 河流不存在
2. 取得水资源段zTree结构json, /segment/systemAdmin/waterResource/tree,GET
    * **角色：所有登录系统的人员，只要有session**
    * 得到前台显示用的segment属性结构json串
    * 包含水资源段属性+所属行政区列表+每个行政区下河长列表
    * 如果是顶级节点，所属行政区列表时所有市州级行政区，如果不是顶级节点，所属行政区是上级行政区的下级行政区列表
    * 参数：
       * waterResourceId,水资源id
    * 返回：
        * OK，JSON
        * DATA_NOEXIST 河流不存在
3. 新建根节点河段，/segment/systemAdmin/river/root/create,POST
   * **角色：系统管理员**
   * pId一定要是0，否则不能新建，返回FAIL
   * 参数：
       * name, 河段名称
       * pId，父级节点id
       * riverId，河流id
       * level 1-市级 2-县级 3-乡级 4-村级
   * 返回：
       * OK，新建成功
4. 新建子节点河段，/segment/systemAdmin/river/create,POST
   * **角色：系统管理员**
   * 判断上级节点是否有行政区，如果没有，不能保存，返回DATA_LOCK
   * 参数：
       * name, 河段名称
       * pId，父级节点id
       * riverId，河流id
   * 返回：
       * OK，新建成功
       * DATA_LOCK 上级节点没有行政区
9. 新建根节点水资源段，/segment/systemAdmin/waterResource/root/create,POST
   * **角色：系统管理员**
   * pId一定要是0，否则不能新建，返回FAIL
   * 参数：
       * name, 水资源段名称
       * pId，父级节点id
       * waterResourceId，水资源id
       * level 1-市级 2-县级 3-乡级 4-村级
   * 返回：
       * OK，新建成功
10. 新建子节点水资源段，/segment/systemAdmin/waterResource/create,POST
   * **角色：系统管理员**
   * 判断上级节点是否有行政区，如果没有，不能保存，返回DATA_LOCK
   * 参数：
       * name, 河段名称
       * pId，父级节点id
       * waterResourceId，水资源id
   * 返回：
       * OK，新建成功
       * DATA_LOCK 上级节点没有行政区
11. 编辑河段，/segment/systemAdmin/update,POST
   * **角色：系统管理员**
   * 编辑河段，水资源段通用
   * 如果是顶级节点，如西宁市河段，pId为0
   * 如果传入的河段行政区id和自己的行政区id不一致，判断是否是叶子节点，可以保存，否则返回DATA_LOCK
   * 如果传入的河段行政区id和自己的行政区id不一致，判断水资源段下是否有河长，如果有河长，返回DATA_LOCK   
   * 参数：
       * id,河段id
       * name, 水资源名称
       * length,水资源长度
       * beginStation,开始位置
       * endStation,结束位置
	   * beginCoor, 开始坐标
	   * endCoor, 结束坐标
       * regionId,行政区id
   * 返回：
       * OK，编辑成功
       * DATA_NOEXIST,水资源，行政区长不存在       
       * DATA_LOCK,河段有下级数据，行政区不能修改
12. 删除河段，/segment/systemAdmin/delete/{id},DELETE
   * **角色：系统管理员**
   * 删除河段，水资源段通用
   * 如果不是叶子节点，不能删除
   * 如果河段下有巡河，不能删除
   * 参数：
       * id,河段id
   * 返回：
       * OK，删除成功
       * DATA_NOEXIST，水资源不存在
       * FAIL，删除失败，水资源下有数据
13. 取得河段详情, /segment/segment/{id},GET
    * **角色：无**
    * 增加河段对应的一河一档兴趣点
    * 参数：id:河段
    * 返回：
        * OK，河段属性：{name,level(河段级别),length,areaCoors,leftCoors,rightCoors,beginStation,endStation,regionName(行政区名)，hzUser:{name，phone},hzb(name,phone), interests:[{...}]}
        * 4022，DATA_REFUSE，请求的河段不属于自己
14. 取得行政区下河段列表，/segment/region/lists, GET
    * **weChat使用**
    * **角色：weChat**
    * 参数：
        * regionCode：行政区编码, 这个regionCode是当先位置的县区级行政编码
    * 返回：
        * OK，行政区下的所有河段，[{id,name},{..}]，如果行政区下没有河道，返回流过市州的所有河流id和name
15. 取得河湖下河段列表，/segment/waterResource/lists, GET
        * **角色：无**
        * 参数：
            * waterResourceId: 河湖id
        * 返回：
            * OK，河湖下所有河段，[{id,name, level, levelC, length},{..}]
16. 取得河长管辖的河段,/segment/lists,GET
    * **app端使用**
    * **角色：各级河长**
    * 参数：无
    * 返回：
        * OK,河道列表，河段列表除了本月巡河次数，还有本年事件总数，正在处理的事件数，本年投诉总数，正在处理的投诉数,[{id,name,level(河段级别),length,beginStation,endStation,regionName(行政区名),cruiseNum(本月巡河次数), matterNum(事件总数),matterHandleNum(事件正在处理数),complaintNum(投诉总数),complaintHandleNum(投诉正在处理数)},{...}]  
17. 移动端原生取得河段的面坐标,/segment/phone/coors,GET
    * **app端使用**
    * 参数：
        * id:河段id
        * token:原生访问传递的token
    * 返回：
        * OK,{areaCoors:[{lat:36.934,lon:102.23,ele:0}, {...}], leftCoors:[{...},{...}], rightCoors:[{...},{...}]}
       

## 八 成员单位，UnitController
1. 新建成员单位,/unit/systemAdmin/create,POST
   * **角色：系统管理员**
   * 成员单位分为三种类型：河长办,水利部门,其他
   * 成员单位下有坐标，标识单位所在地，成员单位下有用户，登录后可以执行相关操作
   * 河长办可以处理日常工作，登记事件，查看统计，考核等；水利部门可以填报水质报表
   * 所有成员单位都可以承办事件
   * 一个行政区内只能有一个河长办类型的成员单位
   * 参数
       * name,单位名称
       * remark,备注
       * phone,联系电话(不用判断唯一性)
       * regionId，所属行政区
       * type, HZB(河长办),HYDROL(水利部门),OTHER(其他)
       * coor, 坐标
       * address, 地址
  * 返回:
	* OK，新建成功
	* DATA_EXIST，行政区内已有河长办，不能再新建河长办
2. 编辑成员单位，/unit/systemAdmin/edit,POST
   * **角色：系统管理员**
   * 类型不可编辑，所属行政区不可编辑
   * 参数
	   * id，unitId
       * name,单位名称
       * remark,备注
       * phone,联系电话(不用判断唯一性)
       * coor, 坐标
       * address, 地址
  * 返回:
	* OK，编辑成功
	* DATA_NOEXIST，成员单位不存在
3. 系统管理员取得成员单位列表,/unit/systemAdmin/lists,GET
  * **角色：系统管理员**
  * 返回的列表，保证河长办在列表最前面
  * 参数
	* regionId, 行政区id
  * 返回
	* OK, 行政区下所有成员单位列表,保证河长办在列表最前面
4. 删除成员单位,/unit/systemAdmin/delete/{id}, DELETE
   * **角色：系统管理员**
   * 如果成员单位下有用户，不能删除
  * 参数
	* id, unitId
  * 返回
	* OK，删除成功
	* DATA_NOEXIST，成员单位不存在
8. 取得成员单位列表，/unit/lists，GET
   * **web端使用**
   * 参数：无
   * 如果是市级河长办，返回市级成员单位，和县级河长办
   * 如果是县级河长办，返回和县级成员单位
   * 其他返回空数组
   * 返回:
       * OK，承办单位所有属性，【{id：xxx,code:xxx, ...},{id:xxx,code:xxx,...}】	
       
       
## 九 成员单位用户，UnitUserController
1. 成员单位用户登录,/unitUser/login,POST
    * **web端使用**
    * **角色：无**
    * 登录成功，除了把unitUser保存在session中，还要保存regionCode, platformId
    * 参数: 
        * phone：手机号
        * password:密码
        * cookie：cookie
    * 返回：
        * OK:登录成功,返回用户属性+成员单位属性，{name:xxx,...}, qqslBucket:xxx, qqslimageBucket:xxx, weChatMenus:[{enum:0, title:新闻动态},{}], articleMenus:[{enum:0, title:新闻动态},{...}]}
        * 4040 CODE_NEED 需要验证码
        * 4023 DATA_LOCK 用户已锁定
        * 4021：DATA_NOEXIST 账号不存在
        * FAIL：密码错误
2. 成员单位用户验证码登录：/unitUser/loginByVerify POST
    * **web端使用**
    * **角色：无**
    * 参数：password:密码；verification:验证码
    * 返回：
        * OK:登录成功,返回用户属性+成员单位属性，{name:xxx,...}, qqslBucket:xxx, qqslimageBucket:xxx, weChatMenus:[{enum:0, title:新闻动态},{}], articleMenus:[{enum:0, title:新闻动态},{...}]}
        * 4041: CODE_INVALID 验证码过期
        * 4042: CODE_ERROR 验证码输入错误
3. 成员单位用户登录发送验证码: /unitUser/login/getLoginVerify
    * **web端使用**
    * **角色：无**
   * 参数
       * phone:手机号
   * 返回：
       * OK:发送成功
       * 4021：DATA_NOEXIST 账号不存在
4. 成员单位用户修改密码:在基本资料的修改密码处点击保存时调用， /unitUser/updatePassword POST
    * **web端使用**
    * **角色：成员单位用户**
   * 参数：
       * oldPassword:当前密码
       * newPassword：新密码
   * 返回：
       * OK:修改成功
       * FAIL:当前密码错误    
5. 成员单位用户注销,/unitUser/logout POST
   * **web端使用**
   * **角色：成员单位用户**
   * 参数：无
   * 返回：OK,注销成功       
6. 获取当前成员单位用户：/unitUser/getUser GET
    * **web端使用**
    * **角色：成员单位用户**
    * 参数：
    * 返回：
       * OK(用户对象)，包含河长办用户所有属性，包含河长办属性
       * 4011: NO_SESSION,未登录

## 十 公众号菜单接口,WeChatController,GET
1. 根据code取得unionId,/weChat/unionId,GET
  * **weChat使用**
  * **角色：无**
  * 取得unionId成功后，将unionId存在session中，直接登录
  * 参数：
    * code，微信code
    * regionCode:行政区编码
  * 返回：
    * OK，{unionId:xxx, name:xxx, qqslBucket:xxx, qqslimageBucket:xxx,level:xxx,weChatMenus:[{enum:0, title:新闻动态},{}], articleMenus:[{enum:0, title:新闻动态},{...}]}
2. 移动端微信用户登录,/weChat/login,POST
   * **app端使用**
   * **角色：无** 
   * 微信登录，把unionId存入session中
   * 参数：
	 * unionId：微信unionId
     * regionCode:行政区编码
   * 返回
     * OK，登录成功  {qqslBucket:xxx, qqslimageBucket:xxx, level:xxx, weChatMenus:[{enum:0, title:新闻动态},{}], articleMenus:[{enum:0, title:新闻动态},{...}}
3. 取得定义的公众号新闻菜单列表,/weChat/articleMenu/define/lists
   * web端
   * 角色：无
   * 返回当前定义的菜单项列表，包含枚举值，中文标题名,是否显示图片[{id:xxx, menu:0, title:州级台账, imageStatus:0},{...}]    
   * 参数：
     * regionCode:行政区编码
   * 返回：
     * OK, 行政区(公众号)下设置的菜单列表,如果没有设置，返回空数组
4. 新建公众号新闻菜单,/weChat/systemAdmin/articleMenu/web/create,POST
   * web端
   * 角色，系统管理员
   * 新建的菜单中的menu必须是没有使用过的，如果使用过返回DATA_EXIST
   * 参数：
     * regionCode:行政区编码
     * title:菜单标题，如市级动态，市级台账等 
     * menu:菜单枚举0-3数字
     * imageStatus: 枚舉，0-不显示，1-显示
   * 返回：
     * OK,新建成功
     * DATA_EXIST,对应菜单已经存在，不能重复新建
5. 修改公众号新闻菜单,/weChat/systemAdmin/articleMenu/web/update,POST
  * web端
  * 角色，系统管理员
  * 参数：
     * id:菜单id
     * title:菜单标题，如市级动态，市级台账等
     * imageStatus: 枚舉，0-不显示，1-显示
  * 返回：
     * OK,修改成功
     * DATA_NOEXIST,菜单不存在
6. 删除公众号新闻菜单,/weChat/systemAdmin/articleMenu/web/delete/{id},DELETE
  * web端
  * 角色，系统管理员
  * 如果该menu菜单下有新闻，不能删除
  * 参数：
     * id:菜单id
  * 返回：
     * OK,删除成功
     * DATA_NOEXIST,菜单不存在          
7. 取得系统内新闻菜单项列表, /weChat/systemAdmin/articleMenu/lists ,GET
  * web
  * 角色，系统管理员
  * 返回系统内菜单项列表，包含枚举值，中文默认标题名,[{menu:0, title:菜单0}, ...]  
  * 用于在添加菜单时，显示所有菜单下拉项      
  * 参数：无
  * 返回：
    * Ok,返回菜单项列表
8. 取得定义的公众号菜单列表,/weChat/menu/define/lists
  * weChat使用
  * web端,角色，无
  * 返回当前定义的菜单项列表，包含枚举值，中文标题名,[{id:xxx, enum:0, title:水情信息},{...}] 
  * 参数：
	* regionCode:行政区编码
  * 返回：
    * OK, 行政区(公众号)下设置的菜单列表,如果没有设置，返回空数组
9. 新建公众号菜单,/weChat/systemAdmin/menu/web/create,POST
   * web端
   * 角色，系统管理员
   * 新建的菜单中的menu必须是没有使用过的，如果使用过返回DATA_EXIST
   * 参数：
     * regionCode:行政区编码
     * title:菜单标题，如市级动态，市级台账等 
     * menu:菜单枚举0-3数字
   * 返回：
     * OK,新建成功
     * DATA_EXIST,对应菜单已经存在，不能重复新建
10. 修改公众号菜单,/weChat/systemAdmin/menu/web/update,POST
  * web端
  * 角色，系统管理员
  * 参数：
     * id:菜单id
     * title:菜单标题，如市级动态，市级台账等
  * 返回：
     * OK,修改成功
     * DATA_NOEXIST,菜单不存在
11. 删除公众号菜单,/weChat/systemAdmin/menu/web/delete/{id},DELETE
  * web端
  * 角色，系统管理员
  * 参数：
     * id:菜单id
  * 返回：
     * OK,删除成功
     * DATA_NOEXIST,菜单不存在          
12. 取得系统内菜单项列表, /weChat/systemAdmin/menu/lists ,GET
  * web
  * 角色，系统管理员
  * 返回系统内菜单项列表，包含枚举值，中文默认标题名,[{enum:0, title:新闻动态},...]  
  * 用于在添加菜单时，显示所有菜单下拉项      
  * 参数：无
  * 返回：
     * OK,返回菜单项列表       

## 十一 河湖长 HzUserController
1. 登录发送验证码: /hzUser/login/getLoginVerify,GET
    * **app端使用**
    * **角色：无**
    * 河长登录时，取得验证码
    * 河长对应的行政区不在 平台 范围内，返回DATA_NOEXIST
    * 参数：
        * phone:登录手机号
        * regionCode:行政区编码
    * 返回：
        * OK:发送成功
        * 4012: DATA_NOEXIST, 手机号不存在
2. 登录：/hzUser/login,POST
    * **app端使用**
    * **角色：无**
    * 河长每次登录都是用动态验证码    
    * 参数：
        * code:验证码 
    * 返回:
        * OK:登录成功,返回河长详情，管辖的河段 {name:xx,regionId,regionName,phone:xx,job:xx,type:xx,riverSegments:[{id,name:xx,length:xx,beginStation:xx,endStation:xx,riverName:xx,regionId,regionName:xx},{...}], qqslBucket:xxx, qqslimageBucket:xxx, weChatMenus:[{enum:0, title:新闻动态},{}], articleMenus:[{enum:0, title:新闻动态},{...}]}
        * 4041: CODE_INVALID 验证码过期
        * 4042: CODE_ERROR 验证码输入错误
3. 新建河长，/hzUser/admin/create,POST
   * **web端使用**
   * **角色：市河长办管理员**
   * code,phone必须唯一
   * 参数：
       * name
       * code，人员编码
       * phone，手机号
       * type，类型
       * remark，备注
       * regionId，行政区id
   * 返回：
       * OK，新建成功
       * DATA_EXIST,code或手机号已使用
       * DATA_REFUSE,不是河长办管辖的行政区
4. 编辑河长，/hzUser/admin/update,POST
   * **web端使用**
   * **角色：市河长办管理员**
   * 参数：
       * id 河长id
       * name 姓名
       * code，人员编码
       * phone，手机号
       * type，类型
       * remark，备注
   * 返回：
       * OK，修改成功
       * DATA_NOEXIST，河长不存在
       * DATA_EXIST,code或手机号已使用
       * DATA_REFUSE,不是河长办管辖的行政区
5. 删除河长,/hzUser/admin/delete/{id},DELETE
   * **web端使用**
   * **角色：市河长办管理员**
   * 参数：
       * id
   * 返回：
       * OK，删除成功 
       * DATA_NOEXIST
       * DATA_REFUSE,不是河长办管辖的行政区
6. 取得河长列表，/hzUser/admin/lists,GET       
   * **web端使用**
   * **角色：市河长办管理员**
   * 参数：
       * regionId,行政区id
   * 返回：
       * OK，取得成功 
       * DATA_NOEXIST，行政区不存在
       * DATA_REFUSE,不是河长办管辖的行政区        
7. 取得河长数量，/hzUser/num,GET
   * **weChat,web端使用**
   * 只返回河长，不返回巡河员
   * **角色：无**
   * 参数：
       * regionCode:行政区编码   
   * 返回： 
       * OK，格式:{regionId:xxx,master(总河长):xxx,slave(副总河长):xxx,city:34,county:123,town:xxx,villlage:xxx, hzUsers:[{name:xxx,job:xxx,riverSegments:[{id:xxx,name:xxx}]}, {...}]}   
8. 取得下级行政区列表及河长数量，/hzUser/region/down/lists,GET
   * **weChat,web端使用**
   * **角色：无**
   * 取得下级行政区列表，包含行政区名称，河长数量
   * level的含义：city, county, town, village
   * 只返回河长，不返回巡河员   
   * 如果level的级别比regionId对应的级别高，就使用本级级别
   * 参数：
       * regionId：行政区Id
       * level: 行政级别的英文名
   * 返回：
       * OK,格式：[{id:xxx,name:xxx,num:xxx},{...}]        
9. 取得行政区下河长及管理河道列表，/hzUser/hzUserInfo/lists,GET
      * **weChat,web端使用**
      * **角色：无**
      * 只返回河长，不返回巡河员         
      * 取得行政区下河长和河长管理的河道信息，河道信息riverSegments，是个字符串，把河道名称用逗号组合起来
      * 参数：
          * regionId：行政区id    
      * 返回:
          * OK,格式：[{name:xxx,job:xxx,riverSegments:[{id:xxx,name:xxx}]}, {...}]
10. 门户取得行政区下河长列表，/hzUser/portal/river/lists,GET
   * **角色：无**
   * 只返回河长，不返回巡河员      
   * 取得平台下级河长列表，河道信息riverSegments，是个字符串，把河道名称用逗号组合起来
   * 比如取得西宁市，返回的是西宁下所有县区，乡，村河长列表
   * 参数：
       * regionCode:行政区编码
       * level: 级别(ALL)，所有，市级，县级，乡级，村级       
   * 返回:
       * OK,格式：[{name:xxx,job:xxx,level:xxx,levelC:xxx,riverSegments:[{id:xxx,name:xxx}]}, {...}]       
11. 门户取得平台下湖长列表,/hzUser/portal/lake/lists,GET
   * **角色：无**
   * 取得平台下级河长列表，不包含巡河员
   * 比如取得西宁市，返回的是西宁下所有县区，乡，村河长列表,使用role角色区分河长，巡河员
   * 参数：
       * regionCode:行政区编码
       * level: 级别，所有(ALL)，市级，县级，乡级，村级       
   * 返回:
       * OK,格式：[{name:xxx,job:xxx,level:xxx,levelC:xxx,riverSegments:[{id:xxx,name:xxx}]}, {...}]  
12. 工作台取得河长，河流数量，/hzUser/workspace/hz/waterResource/num,GET
   * **角色：所有登录系统有session**
   * 取得河长(river)，湖长(lake)，水库(reservoir)列表，根据市，县，乡，村四级计算数量, 不包含巡河员
   * 取得河流(river)，湖泊(lake)，水库(reservoir)列表，根据市，县两级计算数量
   * 参数：
       * regionCode:行政区编码
   * 返回:
       * OK,格式：{hz:[{type:"river", num(总数):xxx,city(市级数量):xxx，county(县级数量):xxx, town(乡级数量):xxx, village(村级数量):xxx}, {...}], waterResource:[{type:"river",num(总数):xxx,city(市级数量):xxx，county(县级数量):xxx}, {...}]}
       
## 十二 投诉，ComplaintControler
1. 公众号提交投诉,/complaint/weChat/submit,POST
    * **weChat使用**
    * **角色：weChat** 
    * 投诉实体中增加imageUrl，上传图片时，把第一张图的地址保存在imageUrl中
    * 参数：
        * title：标题，必需
        * description：描述，由几组关注信息自动组成的，必需
        * content：投诉内容，必需
        * coor:由网页定位识别的经纬度，必需
        * address:由网页定位识别的位置，必需
        * riverSegmentId:选择的河段id，必需
        * riverSegmentName:选择的河段名，必需
        * name:投诉人姓名，可以使匿名
        * @ phone:投诉人电话
        * instanceId:唯一标识
        * mediaIds: "xx,xx,.."
        * unionId，微信唯一标识
    * 返回：
        * OK，建立成功，与登录的user关联
2. 手机app提交投诉,/complaint/phone/submit,POST
    * **app端使用**
    * **角色：weChat** 
    * 参数：
        * title：标题，必需
        * description：描述，由几组关注信息自动组成的，必需
        * content：投诉内容，必需
        * coor:由网页定位识别的经纬度，必需
        * address:由网页定位识别的位置，必需
        * riverSegmentId:选择的河段id，必需
        * riverSegmentName:选择的河段名，必需
        * name:投诉人姓名，可以使匿名
        * @ phone:投诉人电话
        * instanceId:唯一标识
        * imageUrl:封面图片
        * unionId，微信唯一标识
    * 返回：
        * OK，建立成功，与登录的user关联        
3. 公众号取得微信用户的投诉列表，/complaint/weChat/lists,GET
    * **weChat**
    * **角色：weChat** 
    * 参数：
        * unionId，微信唯一标识
    * 返回：
        * OK，返回投诉列表，只需返回id，createDate, title，imageUrl，riverSegmentName, status,handleName, handleDate
4. 门户取得投诉列表,/complaint/portal/lists,GET
    * **角色：无
    * 只查一个月内数据
    * 增加内容缩略 introduce，内容前100个字
    * 参数：
        * regionCode:行政区编码
    * 返回：
        * OK，返回投诉列表，只需返回id，createDate, title, introduce, coor, imageUrl，riverSegmentName, status,handleName, handleDate
5. 门户取得最新投诉列表，/complaint/portal/new/lists,GET
    * **角色：无
    * 投诉内容要发过来,取得最新的五个投诉
    * 参数：
        * regionCode:行政区编码
    * 返回：
        * OK，返回投诉列表，只需返回id，createDate, title, content, coor, imageUrl，riverSegmentName, status,handleName, handleDate        
5. 取得投诉详情，/complaint/complaint,GET
    * **weChat, web端使用**
    * **角色：无** 
    * 投诉实体中增加imageUrl，保存第一张图的地址
    * 参数：
        * instanceId:投诉唯一标识
    * 返回：
        * OK，投诉所有属性
        * FAIL，唯一标识不存在
        * 4022，DATA_REFUSE，请求的投诉不属于自己
6. 回复投诉反馈，/complaint/handle,POST
    * **web端使用**
    * **角色：市河长办** 
    * 如果投诉的 regionCode 和session中保存的 regionCode 不一致，返回错误
    * 参数：
        * id,投诉id
        * handleName,处理人姓名
        * handleContent,回复内容
    * 返回：
        * OK,回复成功        
        * 4022: DATA_REFUSE 投诉不属于河长办 
7. 编辑反馈回复，/complaint/handle/update,POST
    * **web端使用**
    * **角色：市河长办** 
    * 如果投诉的 regionCode 和session中保存的 regionCode 不一致，返回错误
    * 参数：
        * id,投诉id
        * handleName,处理人姓名
        * handleContent,回复内容
    * 返回：
        * OK,编辑成功        
        * 4022: DATA_REFUSE 投诉不属于河长办  
8. 编辑器上传回复图片，/complaint/image/create,POST
    * **web端使用**
    * **角色：市河长办** 
   * 前台编辑器上传图片时调用后台接口，把图片上传到阿里云的qqslimage/hzy/{regionCode}/complaint/handle/，投诉处理图片中，上传时使用https://www.cnblogs.com/jdonson/archive/2009/07/22/1528466.html 方式生成图片的唯一编码
    * 上传时对图片进行压缩，以便用户能快速浏览，参见https://blog.csdn.net/niuch1029291561/article/details/17377903 ,压缩到图片宽度600px
    * 参数： 
    * 使用HttpServletRequest request，转换为MultipartHttpServletRequest multiRequest = (MultipartHttpServletRequest) request，取得图片，参见 https://blog.csdn.net/qq_24419601/article/details/79784773
    * 返回:
        * OK,数据：{"fileName":"文件名.文件格式","url":"上传成功后得资源路径url"} ,资源路径url是阿里云的路径
        * FAIL
9. 河长根据河段取得诉列表，/complaint/riverSegment/lists,GET
    * **app**
    * **角色：河长** 
    * 参数：
        * riverSegmentId:河段id
    * 返回：
        * OK，返回投诉列表，只需返回id，createDate, title，imageUrl，riverSegmentName, status,handleName, handleDate  
10. 投诉统计，/complaint/statistical,GET
   * **角色：app,web所有登录的用户**
   * 统计平台下的投诉，根据县级行政区, 根据投诉交办的行政区，、目前还没有设计交办投诉，所有投诉都统计到市级河长办
   * 本行政区投诉待处理数量，目前还没有设计交办投诉，只有市级河长办才有待处理数量
   * 参数：period: 今日(today),近7一周(week),近一月(month)
   * 返回:
       * OK，json:{regions:[{name:"城东区",id:xxx,num(总数量):xxx，reviewed(已处理数量):xxx,pending(待处理数量):xxx}, {...}], waitNum(待处理):xxx}  
11. **投诉统计查看投诉列表,/complaint/statistical/lists,GET`**
   * **角色：所有登录用户**
   * 取得投诉列表
   * 参数：period: 今日(today),近7一周(week),近一月(month)
   * 返回:
       * OK，列表，投诉对象所有属性        
            
        
## 十三 新闻动态和政策方案, ArticleController 
 1. 取得新闻动态列表,/article/newses,GET
     * **weChat,web端使用**
     * **角色：无**   
     * 参数：
         * regionCode
     * 返回：
         * OK，所属行政区的新闻动态列表，增加 introduce 内容缩略100个字
         * FAIL，行政区不存在
 3. 取得新闻动态详情,/article/article/{id},GET
     * **weChat,web端使用**
     * **角色：无**    
     * 参数：id: 新闻动态id
     * 返回：
         * OK，新闻动态所有属性
         * FAIL，id不存在
 4. 新建文章，/article/admin/create, POST
     * **web端使用**
     * **角色：河长办管理员**    
     * 河长办用户操作，参数中不需要 regionCode，因为session中有这个信息  
     * 参数： 
         * title,文章标题
         * content，文章内容
         * imageUrl，图片
         * menu: 0-3枚举值
     * 返回:
         * OK,保存成功
 5. 修改文章，/article/admin/update, POST
     * **web端使用**
     * **角色：河长办管理员**    
     * 参数： 
         * id,新闻动态id
         * title,文章标题        
         * content，文章内容
         * imageUrl，图片
         * menu，0-3枚举值
     * 返回:
         * OK,保存成功
 6. 上传文章图片，/article/image/create POST
     * **web端使用**
     * **角色：河长办管理员**    
     * 前台编辑器上传图片时调用后台接口，把图片上传到阿里云的qqslimage/hzy/{regionCode}/article/中，上传时使用 https://www.cnblogs.com/jdonson/archive/2009/07/22/1528466.html 方式生成图片的唯一编码
     * 上传时对图片进行压缩，以便用户能快速浏览，参见https://blog.csdn.net/niuch1029291561/article/details/17377903 ,压缩到图片宽度600px
     * 参数： 
     * 使用HttpServletRequest request，转换为MultipartHttpServletRequest multiRequest = (MultipartHttpServletRequest) request，取得图片，参见https://blog.csdn.net/qq_24419601/article/details/79784773
     * 返回:
         * OK,数据：{"fileName":"文件名.文件格式","url":"上传成功后得资源路径url"} ,资源路径url是阿里云的路径
         * FAIL
  7. **`删除文章，/article/delete，POST`**
     * **web端使用**
     * **角色：河长办管理员**   
     * 参数： 
         * id: 文章id
     * 返回:
         * OK,删除成功
         * 4022，DATA_REFUSE，文章不属于自己
         

## 十四 事件管理, MatterController

```
    /**
     * 事件状态
     */
    public enum MatterStatus {
        // 登记
        REGISTER("登记"),
        // 交办
        DELIVER("交办"),
        // 责任退回
        DELIVER_RETURN("责任退回"),
        // 承办
        HANDLE("承办"),
        // 重办
        RE_HANDLE("重办"),
        // 办结
        COMPLETE("办结"),
        // 归档
        ARCHIVE("归档");
    /**
     * 事件来源
     */
    public enum MatterSource {
        // 上级交办
        SUPER_ASSIGN("上级交办"),
        // 系统推送
        SYSTEM_PUSH("系统推送"),
        // 社会媒体监督
        SUPERVISE("社会媒体监督"),
        // 群众投诉
        COMPLAINT("群众投诉"),
        // 巡河记录
        CRUISE("巡河记录"),
        // 河长任务
        HZB_TASK("河长任务");    
```
         
1. 事件登记,/matter/register,POST
   * **app端，web端使用**
   * **角色：各级河长，市河长办**
   * 由0-上级交办 3-群众投诉 5-巡河记录产生的事件，sourceId必传
   * 由1-系统推送 2-社会媒体监督产生的事件，没有sourceId，但有riverId
   * 河长事件登记时，source始终是巡河，sourceId是巡河id
   * 督查督办编号目前由唯一编码方式生成
   * 生成的事件状态是登记
   * 记录登记人员
   * 参数：
       * code: 督查督办编号
       * title: 标题
       * content: 内容
       * source: 事件来源
       * @sourceId: 来源id,如果来源是投诉，那么来源id就是投诉id
       * @riverId: 河流id
   * 返回：
       * OK，建立成功
2. 事件交办,/matter/deliver,POST
    * **web端使用**
    * **角色：市河长办**
    * 事件状态必须是登记或责任退回才能交办
    * 有sourceId的，0-上级交办 3-群众投诉 4-河长报告 5-巡河记录产生的事件，通过sourceId找到河段id，再找到riverId，再根据河长办，得到县级河段，存到riverSegmentId
    * 没有sourceId的，必须由前台传递河流id，得到县级河段，存到riverSegmentId          
    * 事件改为状态是交办
    * 事件的河段id此时确定
    * 如果河流不属于这个市河长办，返回错误    
    * 紧急程度：0-一般 1-加急 2-紧急
    * 参数：
        * id: 事件id
        * unitId: 交办给的成员单位id
        * requirement: 办理要求
        * deadline: 时限要求
        * emergency: 紧急程度
      * 返回：
        * OK: 交办成功
        * 4111: MATTER_TYPE_ERROR 事件状态错误
        * 4022: DATA_REFUSE，河流不在选择范围内，无法交办
3. 事件承办,/matter/handle,POST
    * **web端使用**
    * **角色：成员单位**
   * 事件是交办或审核退回的，可以进行承办
   * 事件改为状态是承办
   * 承办时可以上传图片，由前台处理
   * 参数： 
       * id: 事件id 
       * description: 承办描述
    * 返回： 
       * OK: 承办成功
       * 4111: MATTER_TYPE_ERROR 事件状态错误
       * 4022: DATA_REFUSE，事件不属于该河长办
4. 事件办结,/matter/complete,POST
    * **web端使用**
    * **角色：成员单位**
    * 事件状态改为办结
    * 办结时可以上传图片，由前台处理
    * 参数：
        * id：事件id
        * description: 办结描述
        * 4111: MATTER_TYPE_ERROR 事件状态错误
        * 4022: DATA_REFUSE，事件不属于该河长办        
5. 事件审核不通过，审核退回,/matter/returnBack,POST
    * **web端使用**
    * **角色：市河长办**
    * 事件状态改为审核退回
    * 审核时可以上传图片，由前台处理
    * 参数：
        * id： 事件id
        * description: 审核描述
    * 返回:
        * OK: 退回成功       
        * 4111: MATTER_TYPE_ERROR 事件状态错误
6. 事件归档,/matter/archive,POST
    * **web端使用**
    * **角色：市河长办**
    * 事件状态改为归档
    * 参数：
        * id： 事件id
        * description: 审核描述 
    * 返回：
        * OK: 归档成功
        * 4111: MATTER_TYPE_ERROR 事件状态错误
7. 事件催办,/matter/urgent,POST
    * **web端使用**
    * **角色：市河长办**
    * 市河长办发起
    * 事件状态必须是承办，才能接受催办
    * 参数：
        * id：事件id
        * content: 催办内容
    * 返回：
        * OK：催办成功
        * 4111: MATTER_TYPE_ERROR 事件状态错误
8. 事件催办回复,/matter/urgent/result,POST
    * **web端使用**
    * **角色：成员单位**
    * 县区河长办分回复
    * 参数：
        * id: 事件催办id
        * result: 回复内容
    * 返回：
        * OK：回复成功
        * 4022: DATA_REFUSE，事件催办不属于该河长办        
9. 事件反馈,/matter/feedBack,POST
    * **web端使用**
    * **角色：成员单位**
    * 县区河长办发起
    * 事件状态必须是承办，才能反馈
    * 参数：
        * id：事件id
        * content: 反馈内容
    * 返回：
        * OK：反馈成功
        * 4111: MATTER_TYPE_ERROR 事件状态错误
10. 事件反馈回复：/matter/feedBack/result,POST
    * **web端使用**
    * **角色：市河长办**
    * 市河长办回复
    * 参数：
        * id: 事件催办id
        * result: 回复内容
    * 返回：
        * OK：回复成功
        * 4010: UNAUTHORIZED，非市级河长办不能进行操作
9. 事件责任退回,/matter/deliver/returnBack,POST
    * **web端使用**
    * **角色：成员单位**
   * 事件状态必须是交办
   * 事件必须在24小时内
   * 参数：
       * id: 事件id
       * description：责任退回描述
   * 返回：
        * OK：反馈成功
        * 4111: MATTER_TYPE_ERROR 事件状态错误
        * 4112: MATTER_TIMEOUT 交办超时，不能责任退回
11. **`取得办理的事件列表,/matter/handle/lists,GET`**
   * **web端使用**
   * **角色：市河长办用户，县河长办用户**
   * 取得未归档的事件列表
   * 如果是市级河长办，根据外键取得事件列表
   * 如果是县级河长办，根据交办单位deliverUnitId取得
   * 参数：无
   * 返回:
       * OK，列表，事件对象所有属性，不包含文件列表，包含子对象
12. **`取得归档事件列表,/matter/archive/lists,GET`**
   * **web端使用**
   * **角色：市河长办用户，成员单位用户**
   * 取得已归档的事件列表
   * 如果是市级河长办，根据外键取得事件列表
   * 如果是县级河长办，根据交办单位deliverUnitId取得   
   * 参数：无
   * 返回:
       * OK，列表，事件对象所有属性，不包含文件列表，包含子对象
13. 编辑器上传事件图片，/matter/image/create,POST
    * 涉及到登记，承办，办结时，编辑器上传的图片
    * **web端使用**
    * **角色：县，市河长办用户**    
    * 前台编辑器上传图片时调用后台接口，把图片上传到阿里云的/qqsl/hzy/{regionCode}/matter/{code}/image中，上传时使用 https://www.cnblogs.com/jdonson/archive/2009/07/22/1528466.html 方式生成图片的唯一编码
    * 上传时对图片进行压缩，以便用户能快速浏览，参见https://blog.csdn.net/niuch1029291561/article/details/17377903 ,压缩到图片宽度600px
    * 参数： 
    * 使用HttpServletRequest request，转换为MultipartHttpServletRequest multiRequest = (MultipartHttpServletRequest) request，取得图片，参见https://blog.csdn.net/qq_24419601/article/details/79784773
    * 返回:
        * OK,数据：{"fileName":"文件名.文件格式","url":"上传成功后得资源路径url"} ,资源路径url是阿里云的路径
        * FAIL           
14. 查看事件详情,/matter/details/{code},GET
    * **web端使用**
    * **角色：app,web所有登录的用户**
    * 列出事件所有数据
    * 参数：code，督查督办编号
    * 返回：
        * 事件所有属性，事件图片list
        * 事件处理列表，每个列表中的承办文件list，办结文件list
        * 事件下发,上报列表
15. **`根据河段取得事件列表,/matter/riverSegment/lists,GET`**
   * **角色：app,web所有登录的用户**
   * 根据河段id，取得年内所有事件列表
   * 参数：riverSegmentId:河段id
   * 返回:
       * OK，列表，事件对象所有属性，不包含文件列表，包含子对象      
16. 事件统计，/matter/statistical,GET
   * **角色：app,web所有登录的用户**
   * 统计平台下的事件，根据县级行政区, 根据事件交办河长办对应的行政区
   * 统计本行政区代办事件
   * 参数：period: 今日(today),近7一周(week),近一月(month)
   * 返回:
       * OK，json:{regions:[{name:"城东区",id:xxx,num(总数量):xxx,complete(已办结数量):xxx,handle(承办中数量):xxx,deliver(待办数量):xxx}, {...}], waitNum(待办数量):xxx}
17. **事件统计查看所有未归档事件,/matter/statistical/handle/lists,GET`**
   * **角色：所有登录用户**
   * 取得未归档的事件列表
   * 参数：period: 今日(today),近7一周(week),近一月(month)
   * 返回:
       * OK，列表，事件对象所有属性
         
## 十五 巡河控制层, CruiseController 
1. 取得河段巡河记录类型,/cruise/recordType,GET
    * **weChat, app端使用**
    * **角色：weChat, 河长, 巡河员**
   * 参数：无
   * 返回：
       * OK,[{type:类型英文,value:类型中文，description:["xxx","..."]}]
2. 上传巡河,/cruise/add,POST
    * **app端使用**
    * **角色：河长,巡河员**
   * 参数：
       * SegmentId:河道id
       * cruiseRecords:[{type,description,content,coor,address,,instanceId(唯一标识),interestId(关注点id)},{..}]
       * cruise:{beginTime(开始时间),content,path(巡河路径),duration(巡河时长),length(巡河里长),instanceId:唯一标识}
   * 返回：
       * OK,建立成功
       * 4022，DATA_REFUSE，请求的河段不属于自己
3. 查询河段所有巡河,/cruise/lists/{riverSegmentId},GET
    * **app端, web端使用**
    * **角色：各级河长, 巡河员，河长办**
    * 参数：riverSegmentId，河道id
    * 返回：
        * OK，河长在这个河段的巡河记录,[{instanceId,beginTime,conten,path(巡河路径),duration(巡河时长),length(巡河里长),recordNum(记录数)}]
        * 4022，DATA_REFUSE，请求的河段不属于自己
4. 查看巡河详情,/cruise/cruise/{instanceId},GET
    * **app端, web端使用**
    * **角色：各级河长, 巡河员，河长办用户**
    * 必须是同一平台下人查看
    * 参数：instanceId，巡河记录标识
    * 返回：
        * OK，{beginTime,content,path,duration,length, riverSegmentId, riverSegmentName, hzUserId, hzUserName, hzUserPhone, hzbId, hzbName, hzbPhone, cruiseRecords:[{type,description,content,coor,address,instanceId,interest:{name,type}},{..}]}
        * 4022，DATA_REFUSE，不是同一平台下
5. 查看月巡河列表，/cruise/lists,GET
    * **app端, web端使用**
    * **角色：河长，河长办**
    * 列出平台下月巡河列表
    * 参数：period: 近一月(month),近三月(three_month),全部(all)
    * 返回：
        * OK，河长办本级河长，对应河段月巡河列表,json示例
6. 巡河统计，/curise/statistical,GET
   * **角色：app,web所有登录的用户**
   * 统计平台下的巡河数量，根据县级行政区
   * 统计未查看的巡河数量
   * 参数：period: 今日(today),近7一周(week),近一月(month)
   * 返回:
       * OK，json:{regions:[{name:"城东区",id:xxx,num(巡河次数):xxx，hzUser(巡河人数):xxx，duration("巡河时长"):xxx,length("巡河公里数"):xxx, record("发现问题数"):xxx}, {...}], waitNum:xxx}   
7. **巡河统计查看列表,/cruise/statistical/lists,GET`**
   * **角色：所有登录用户**
   * 取得未归档的巡河列表
   * 参数：period: 今日(today),近7一周(week),近一月(month)
   * 返回:
       * OK，列表，巡河、对象所有属性       
       
## 十六 信息收发，UnitContactController
1 发送信息，/unitContact/send,POST
   * **角色：所有河长办用户**
   * 选择河长办，发送信息及附件
   * 参数：
      * receiveUnitId:接收河长办
      * title: 标题
      * content: 内容
   * 返回:
       * OK，发送成功
2 查看自己发送的消息列表，/unitContact/send/lists,GET
   * **角色：所有河长办用户**
   * 返回:
       * OK，[{id:xxx, titel:xxx, status:xxx, statusC:xxx, intrduce(内容缩略):xxx}, {...}]
3 查看接收的消息列表，/unitContact/receive/lists,GET
   * **角色：所有河长办用户**
   * 参数：无
   * 返回:
       * OK，[{id:xxx, titel:xxx, status:xxx, statusC:xxx, intrduce(内容缩略):xxx}, {...}]
4 回复消息，/unitContact/receive/reply,POST
   * **角色：所有河长办用户**
   * 选择河长办，发送信息及附件
   * 参数：
      * content:回复内容
      * replyId: 
   * 返回:
       * OK，发送成功
       
## 十七 PanoramaController，全景
1. 取得全景列表，/panorama/lists,GET
    * **weChat, web端使用**
    * **角色：无** 
    * 参数：
       * regionCode：行政区编码
    * 返回：
        * OK，行政区下的全景列表,包含name，createDate(建立时间),instanceId(唯一编码),thumbUrl(缩略图)，coor(坐标)，address(位置)
       
         
~~~
   /**
     * 河湖类型
     */
    RIVER("河流"),
    LAKE("湖泊"),
    RESERVOIR("水库"),
    WATER_PLACE("水源地"),
    IRRIGATION_AREA("灌区"),
    DRINGING_WATER("人畜饮水");
    
    /**
      扩展项类型
      */
        BILLBOARD("公示牌"),
        RESERVOIR("水库"),
        IRRIGATION("灌区"),
        INTAKE("取水口"),
        DRINKING_WATER_SOURCES("饮用水源地"),
        OUTLET("排污口"),
        SEWAGE_FACTORY("污水处理厂"),
        FIRST_GRADE_WATER_FUNCTION("一级水功能区"),
        SECOND_GRADE_WATER_FUNCTION("二级水功能区"),
        WHARF("港口码头"),
        BANK_PROTECTION("堤岸护坡"),
        BARRIER_GATE("拦河闸"),
        PUMPING_STATION("泵站"),
        POWER_STATION("水电站"),
        RUBBER_DAM("橡胶坝"),
        ROLLING_DAM("滚水坝"),
        NAVIGATION_BUILDING("通航建筑物"),
        BRIDGE("桥梁"),
        CULVERT("涵洞"),
        TUNNEL("隧洞"),
        AQUEDUCT("渡槽"),
        ECOLOGICAL_PROTECTED_AREAS("生态保护区"),
        WETLAND_PARK_ALONG_LAKE("沿湖湿地公园"),
        AQUATIC_BIOLOGICAL_RESERVE("水生生物保护区"),
        LEVEE("堤防"),
        SLUICE("水闸"),
        NATURE_AND_CULTURAL_RESOURCES_RESERVE("自然文化资源保护区"),
        NATIONAL_KEY_ECO_FUNCITIONAL_AREAS("国家重点生态功能区"),
        NATIONAL_KEY_SCENIC_SPOTS("重点风景名胜区");
~~~

~~~
行政区枚举:
    /**
     * 行政区级别
     */
    public enum RegionLevel {
        // 省
        PROVINCE,
        // 市
        CITY,
        // 县
        COUNTY,
        // 乡
        TOWN,
        // 村
        VILLAGE,
        // 所有
        ALL       
    }
河长枚举:
    /**
     * 河长级别
     */
    public enum HzType {
        // 总河长
        MASTER,
        // 副总河长
        SLAVE,
        // 河长
        NORMAL
    }  
    // 成员单位角色
    unitUser:simple,unitUser:conservancy,unitUser:city,unitUser:county
~~~

## 门户使用的接口
7. 取得河长数量，/hzUser/num,GET
10. 门户取得行政区下河长列表，/hzUser/portal/river/lists,GET
4. 门户取得投诉列表,/complaint/portal/lists,GET
5. 门户取得最新投诉列表，/complaint/portal/new/lists,GET
5. 取得投诉详情，/complaint/complaint,GET
7. 门户地图取得平台下所有河湖坐标,/waterResource/portal/map/lists,GET
8. 门户取得河湖列表,/waterResource/portal/lists,GET
9. 门户取得河湖档案，/waterResource/portal/details/{id}, GET
1. 取得全景列表，/panorama/lists,GET
1. 取得新闻动态列表,/article/newses,GET
3. 取得新闻动态详情,/article/article/{id},GET

## 水利地图使用的接口
7. 门户地图取得平台下所有河湖坐标,/waterResource/portal/map/lists,GET
11. 地图取得河流二级图层数据，/waterResource/second/details/{id},GET
15. 取得河湖下河段列表，/segment/waterResource/lists, GET
13. 取得河段详情, /segment/segment/{id},GET
2. 取得扩展项列表,/extra/lists
2. 取得扩展项详情,/extra/details/{id},GET
9. 门户取得河湖档案，/waterResource/portal/details/{id}, GET

17. **事件统计查看所有未归档事件,/matter/statistical/handle/lists,GET`**
11. 投诉统计查看投诉列表,/complaint/statistical/lists,GET
7. **巡河统计查看列表,/cruise/statistical/lists,GET`**

## 工作台接口
12. 工作台取得河长，河流数量，/hzUser/workspace/hz/waterResource/num,GET